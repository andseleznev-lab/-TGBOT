# PRD: –ú–∏–≥—Ä–∞—Ü–∏—è club.json –Ω–∞ Supabase —Å Realtime –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏

**–¢–∏–∫–µ—Ç**: T-006
**–ê–≤—Ç–æ—Ä**: Claude + Andrej Seleznev
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 2026-02-14
**–°—Ç–∞—Ç—É—Å**: PRD_READY

---

## –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

–ó–∞–º–µ–Ω—è–µ–º —Ñ–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ club.json (GitHub Pages) –Ω–∞ Supabase PostgreSQL —Å Realtime –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —É—Å–ø–µ—à–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ –∫–ª—É–±–∞ –±–µ–∑ polling –∏ –∑–∞–¥–µ—Ä–∂–µ–∫ CDN –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è.

---

## –ü—Ä–æ–±–ª–µ–º–∞ / –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å

### –ö–æ–Ω—Ç–µ–∫—Å—Ç

**–¢–µ–∫—É—â–∞—è –±–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**:
- –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ –∫–ª—É–±–∞ (2990‚ÇΩ) –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∂–¥—ë—Ç 4-5 –º–∏–Ω—É—Ç, –ø–æ–∫–∞ –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤—è—Ç—Å—è
- –î–∞–∂–µ —Å —É—Å–∫–æ—Ä–µ–Ω–Ω—ã–º polling (3 —Å–µ–∫ √ó 50 –ø–æ–ø—ã—Ç–æ–∫ = 2.5 –º–∏–Ω) –ø–ª–∞—Ç—ë–∂ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç—Å—è –∏–∑-–∑–∞ CDN –∫–µ—à–∞
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —É–≤–µ—Ä–µ–Ω: "–ø—Ä–æ—à–ª–∞ –ª–∏ –æ–ø–ª–∞—Ç–∞?" ‚Üí –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–π UX, –≤–æ–∑–º–æ–∂–Ω—ã –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞**:
- GitHub Pages –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Fastly CDN —Å –∂—ë—Å—Ç–∫–∏–º –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º 4-5 –º–∏–Ω—É—Ç
- –ü–∞—Ä–∞–º–µ—Ç—Ä `?t=Date.now()` –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è CDN
- –£ –Ω–∞—Å –Ω–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ `Cache-Control`
- Polling —Ä–∞—Å—Ö–æ–¥—É–µ—Ç —Ä–µ—Å—É—Ä—Å—ã –∏ –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ —É—Å–ø–µ–≤–∞–µ—Ç

### –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è (AS IS)

```mermaid
sequenceDiagram
    User->>YooKassa: –û–ø–ª–∞—Ç–∞ 2990‚ÇΩ
    YooKassa->>Make.com: Webhook (succeeded)
    Make.com->>GitHub: Commit club.json
    GitHub->>Fastly CDN: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
    Note over Fastly CDN: –ö–µ—à 4-5 –º–∏–Ω—É—Ç
    loop Polling –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫
        MiniApp->>Fastly CDN: GET club.json?t=...
        Fastly CDN-->>MiniApp: –°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è (–∫–µ—à)
    end
    Note over User: –ñ–¥—ë—Ç 4-5 –º–∏–Ω—É—Ç üòû
```

**–ü—Ä–æ–±–ª–µ–º—ã**:
1. ‚è±Ô∏è –í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: 4-5 –º–∏–Ω—É—Ç (–Ω–µ–ø—Ä–∏–µ–º–ª–µ–º–æ)
2. üîÑ –ë–µ—Å–ø–æ–ª–µ–∑–Ω—ã–π polling: 50 –∑–∞–ø—Ä–æ—Å–æ–≤ √ó 3 —Å–µ–∫ = –∏–∑–ª–∏—à–Ω—è—è –Ω–∞–≥—Ä—É–∑–∫–∞
3. üìâ –ü–ª–æ—Ö–æ–π UX: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–Ω–∞–µ—Ç, –ø—Ä–æ—à–ª–∞ –ª–∏ –æ–ø–ª–∞—Ç–∞
4. üö´ –ù–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è: GitHub Pages –Ω–µ –¥–∞—ë—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∫–µ—à–µ–º

### –ñ–µ–ª–∞–µ–º–∞—è —Å–∏—Ç—É–∞—Ü–∏—è (TO BE)

```mermaid
sequenceDiagram
    User->>YooKassa: –û–ø–ª–∞—Ç–∞ 2990‚ÇΩ
    YooKassa->>Make.com: Webhook (succeeded)
    Make.com->>Supabase: INSERT payment (REST API)
    Supabase-->>MiniApp: Realtime push (WebSocket)
    Note over MiniApp: –ú–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ø–µ—Ö ‚úÖ
    MiniApp->>User: Popup "–ê–±–æ–Ω–µ–º–µ–Ω—Ç –∫—É–ø–ª–µ–Ω!"
    Note over User: < 1 —Å–µ–∫—É–Ω–¥—ã üöÄ
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
1. ‚ö° –í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: **< 1 —Å–µ–∫—É–Ω–¥–∞**
2. üöÄ –ù–µ—Ç polling: WebSocket push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
3. ‚úÖ –û—Ç–ª–∏—á–Ω—ã–π UX: –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
4. üìä –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å: –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ –¥–∞–Ω–Ω—ã–µ (–≤—Å—Ç—Ä–µ—á–∏, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

#### Must Have

- [x] –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `club_payments` –≤ Supabase —Å –ø–æ–ª—è–º–∏:
  - `id` (UUID, primary key)
  - `payment_id` (TEXT, unique, –æ—Ç YooKassa)
  - `telegram_user_id` (BIGINT, –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏)
  - `amount` (INTEGER, –∫–æ–ø–µ–π–∫–∏)
  - `status` (TEXT: pending/succeeded/canceled)
  - `created_at` (TIMESTAMPTZ)
  - `payment_data` (JSONB, –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç YooKassa)

- [x] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Row Level Security (RLS):
  - –ü—É–±–ª–∏—á–Ω—ã–π READ –¥–æ—Å—Ç—É–ø (–¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞)
  - –ó–∞–ø—Ä–µ—Ç–∏—Ç—å INSERT/UPDATE/DELETE –¥–ª—è anon –∫–ª—é—á–∞
  - –¢–æ–ª—å–∫–æ service_role –º–æ–∂–µ—Ç –ø–∏—Å–∞—Ç—å (Make.com)

- [x] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Make.com:
  - –ó–∞–º–µ–Ω–∏—Ç—å "GitHub commit" –Ω–∞ "Supabase ‚Üí Insert record"
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `service_role` –∫–ª—é—á (—Å–µ–∫—Ä–µ—Ç–Ω—ã–π)
  - –ó–∞–ø–∏—Å—ã–≤–∞—Ç—å –ø–ª–∞—Ç–µ–∂–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ webhook –æ—Ç YooKassa

- [x] –û–±–Ω–æ–≤–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥:
  - –ü–æ–¥–∫–ª—é—á–∏—Ç—å Supabase JS SDK (CDN)
  - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Realtime –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ INSERT –≤ `club_payments`
  - –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø–ª–∞—Ç–µ–∂–∞ ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å success popup + haptic feedback
  - –û–±–Ω–æ–≤–∏—Ç—å UI –≤–∫–ª–∞–¥–∫–∏ "–ö–ª—É–±" (–æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å Zoom —Å—Å—ã–ª–∫—É)

- [x] –£–±—Ä–∞—Ç—å —Å—Ç–∞—Ä—ã–π –∫–æ–¥:
  - –£–¥–∞–ª–∏—Ç—å `loadClubData()` –∏–∑ app.js
  - –£–¥–∞–ª–∏—Ç—å polling —Ñ—É–Ω–∫—Ü–∏–∏ (`startClubPaymentPolling`, `startBackgroundPolling`)
  - –£–¥–∞–ª–∏—Ç—å club.json –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ backup)

#### Should Have

- [ ] –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ club.json –≤ Supabase (–µ—Å–ª–∏ –µ—Å—Ç—å)
- [ ] –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ `telegram_user_id` –∏ `status` –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ Realtime –ø–æ–¥–ø–∏—Å–∫–∏
- [ ] Graceful fallback: –µ—Å–ª–∏ WebSocket –æ—Ç–≤–∞–ª–∏–ª—Å—è, –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- [ ] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π (–Ω–µ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ)

#### Could Have (Nice to Have)

- [ ] Dashboard –≤ Supabase Studio –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø–ª–∞—Ç–µ–∂–µ–π
- [ ] Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –Ω–æ–≤–æ–º –ø–ª–∞—Ç–µ–∂–µ (—á–µ—Ä–µ–∑ Supabase Edge Functions)
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –ø–ª–∞—Ç–µ–∂–µ–π –≤ CSV –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

### –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (NFR)

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**:
- –í—Ä–µ–º—è –æ—Ç –ø–ª–∞—Ç–µ–∂–∞ –¥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: **< 1 —Å–µ–∫—É–Ω–¥–∞** (99 –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å)
- WebSocket reconnect –ø—Ä–∏ –æ–±—Ä—ã–≤–µ: **< 3 —Å–µ–∫—É–Ω–¥—ã**
- –†–∞–∑–º–µ—Ä Supabase SDK (CDN): **~50KB gzipped** (–ø—Ä–∏–µ–º–ª–µ–º–æ)

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**:

–î–µ—Ç–∞–ª—å–Ω–∞—è —Å–µ–∫—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: —Å–º. —Ä–∞–∑–¥–µ–ª "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∑–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö" –Ω–∏–∂–µ

**UX/UI**:
- Haptic Feedback –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø–ª–∞—Ç–µ–∂–∞ (`notificationOccurred('success')`)
- Success popup —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º "‚úÖ –ê–±–æ–Ω–µ–º–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ –∫—É–ø–ª–µ–Ω!"
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI (Zoom —Å—Å—ã–ª–∫–∞, —Å—Ç–∞—Ç—É—Å –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞)
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

**–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å**:
- Supabase SLA: 99.9% uptime
- PostgreSQL ACID –≥–∞—Ä–∞–Ω—Ç–∏–∏ (–Ω–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π reconnect –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

---

## –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π (Happy Path)

**–î–µ–π—Å—Ç–≤—É—é—â–∏–µ –ª–∏—Ü–∞**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, YooKassa, Make.com, Supabase, Mini App

**–ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è**:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–ª Mini App, –≤–∫–ª–∞–¥–∫–∞ "–ö–ª—É–±"
- –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ù–ï–¢ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞
- Supabase Realtime –ø–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞ (WebSocket connected)

**–®–∞–≥–∏**:

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–ö—É–ø–∏—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç 2990‚ÇΩ"
2. –°–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞—ë—Ç –ø–ª–∞—Ç—ë–∂ —á–µ—Ä–µ–∑ Make.com ‚Üí YooKassa
3. –°–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–û–ø–ª–∞—Ç–∏—Ç—å" ‚Üí –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è YooKassa –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç (–±–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞)
6. YooKassa –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç webhook "payment.succeeded" ‚Üí Make.com
7. Make.com –≤—Å—Ç–∞–≤–ª—è–µ—Ç –∑–∞–ø–∏—Å—å –≤ Supabase: `INSERT INTO club_payments (...)`
8. Supabase –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç Realtime event —á–µ—Ä–µ–∑ WebSocket ‚Üí Mini App
9. Mini App –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ `postgres_changes` —Å –Ω–æ–≤—ã–º –ø–ª–∞—Ç–µ–∂–æ–º
10. –°–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç success popup: "‚úÖ –ê–±–æ–Ω–µ–º–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ –∫—É–ø–ª–µ–Ω!"
11. –°–∏—Å—Ç–µ–º–∞ –≤—ã–∑—ã–≤–∞–µ—Ç `tg.HapticFeedback.notificationOccurred('success')`
12. –°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç UI: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç Zoom —Å—Å—ã–ª–∫—É, –∫–Ω–æ–ø–∫—É "–û—Ç–º–µ–Ω–∏—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç"

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ **< 1 —Å–µ–∫—É–Ω–¥—ã** –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã
- UI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—ë–Ω (–Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—Ç—å)
- –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ Supabase (–Ω–∞–¥—ë–∂–Ω–æ, ACID)

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

#### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–∫—Ä—ã–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–æ –≤—Ä–µ–º—è –æ–ø–ª–∞—Ç—ã

**–®–∞–≥–∏**:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –≤ YooKassa
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–∫—Ä—ã–≤–∞–µ—Ç Mini App (–≤–∫–ª–∞–¥–∫—É)
3. –ü–ª–∞—Ç—ë–∂ —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç ‚Üí Make.com –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ Supabase
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Mini App —Å–Ω–æ–≤–∞
5. –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Supabase Realtime
6. –°–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø–ª–∞—Ç–µ–∂–∏ —á–µ—Ä–µ–∑ REST API: `GET /club_payments?telegram_user_id=eq.{userId}&status=eq.succeeded`
7. –°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –ø–ª–∞—Ç—ë–∂, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç UI —Å –∞–∫—Ç–∏–≤–Ω—ã–º –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–º

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –î–∞–∂–µ –µ—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—ã–ª–æ –∑–∞–∫—Ä—ã—Ç–æ, –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å.

#### –°—Ü–µ–Ω–∞—Ä–∏–π 3: WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—è–Ω–æ

**–®–∞–≥–∏**:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ
2. –ú–æ–±–∏–ª—å–Ω–∞—è —Å–µ—Ç—å –æ–±—Ä—ã–≤–∞–µ—Ç—Å—è (—Å–ª–∞–±—ã–π —Å–∏–≥–Ω–∞–ª)
3. WebSocket –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç (–∏—Å–ø–æ–ª—å–∑—É—è –º–æ–±–∏–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —á–µ—Ä–µ–∑ YooKassa)
5. –ü–ª–∞—Ç—ë–∂ –ø—Ä–æ—Ö–æ–¥–∏—Ç ‚Üí Supabase –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
6. –ù–æ Realtime push –ù–ï –¥–æ—Ö–æ–¥–∏—Ç (WebSocket –æ–±–æ—Ä–≤–∞–Ω)
7. Supabase SDK –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è (reconnect)
8. –ü–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–∞ –¥–µ–ª–∞–µ—Ç REST –∑–∞–ø—Ä–æ—Å –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
9. –°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–π –ø–ª–∞—Ç—ë–∂, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç success popup

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: Graceful degradation ‚Äî –¥–∞–∂–µ –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ WebSocket –¥–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è.

### –ò—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏ (Edge Cases)

**–û—à–∏–±–∫–∞ 1**: Make.com –Ω–µ —Å–º–æ–≥ –∑–∞–ø–∏—Å–∞—Ç—å –≤ Supabase (–Ω–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á)
- **–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω `service_role` –∫–ª—é—á –∏–ª–∏ RLS –ø–æ–ª–∏—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç
- **–û–±—Ä–∞–±–æ—Ç–∫–∞**: Make.com –ª–æ–≥–∏—Ä—É–µ—Ç –æ—à–∏–±–∫—É, –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –∑–∞–ø—Ä–æ—Å (retry 3 —Ä–∞–∑–∞)
- **–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é**: –ï—Å–ª–∏ –ø–æ—Å–ª–µ 3 –º–∏–Ω—É—Ç –ø–ª–∞—Ç—ë–∂ –Ω–µ –ø–æ—è–≤–∏–ª—Å—è ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é "–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ –≤–∫–ª–∞–¥–∫—É '–ö–ª—É–±' –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è"
- **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Make.com —Å—Ü–µ–Ω–∞—Ä–∏—è –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

**–û—à–∏–±–∫–∞ 2**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—Ç–∏–ª, –Ω–æ –Ω–µ –ø–æ–ª—É—á–∏–ª Realtime —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (–≤—Ä–µ–º–µ–Ω–Ω—ã–π –±–∞–≥)
- **–ü—Ä–∏—á–∏–Ω–∞**: WebSocket –æ—Ç–≤–∞–ª–∏–ª—Å—è / –±—Ä–∞—É–∑–µ—Ä –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª / —Å–µ—Ç–µ–≤–∞—è –ø—Ä–æ–±–ª–µ–º–∞
- **–û–±—Ä–∞–±–æ—Ç–∫–∞**: –ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–ö–ª—É–±" –¥–µ–ª–∞–µ–º REST –∑–∞–ø—Ä–æ—Å –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- **–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é**: –ù–æ—Ä–º–∞–ª—å–Ω—ã–π UI —Å –∞–∫—Ç–∏–≤–Ω—ã–º –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–º (–±–µ–∑ popup)
- **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –î–æ–±–∞–≤–∏—Ç—å fallback: –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥ –¥–µ–ª–∞—Ç—å REST –∑–∞–ø—Ä–æ—Å (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–∂–∏–¥–∞–µ—Ç—Å—è –ø–ª–∞—Ç—ë–∂)

**–û—à–∏–±–∫–∞ 3**: –î—É–±–ª–∏—Ä—É—é—â–∏–µ –ø–ª–∞—Ç–µ–∂–∏ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–Ω—É–ª 2 —Ä–∞–∑–∞ –ø–æ–¥—Ä—è–¥)
- **–ü—Ä–∏—á–∏–Ω–∞**: –ö–Ω–æ–ø–∫–∞ –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∞—Å—å, —Å–æ–∑–¥–∞–ª–∏—Å—å 2 –ø–ª–∞—Ç–µ–∂–∞
- **–û–±—Ä–∞–±–æ—Ç–∫–∞**:
  - Make.com –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `payment_id` (unique constraint –≤ Supabase)
  - –ï—Å–ª–∏ –¥—É–±–ª—å ‚Üí –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è (constraint violation)
  - –í UI –±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–∫–∞ (`disabled = true`)
- **–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é**: –û–¥–∏–Ω success popup (–¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞)
- **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ T-005 (–∑–∞—â–∏—Ç–∞ –æ—Ç –¥–≤–æ–π–Ω—ã—Ö –∫–ª–∏–∫–æ–≤)

**–û—à–∏–±–∫–∞ 4**: Supabase –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (503 Service Unavailable)
- **–ü—Ä–∏—á–∏–Ω–∞**: –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã / –∞–≤–∞—Ä—ñ—è
- **–û–±—Ä–∞–±–æ—Ç–∫–∞**:
  - REST –∑–∞–ø—Ä–æ—Å—ã –ø–∞–¥–∞—é—Ç —Å –æ—à–∏–±–∫–æ–π
  - WebSocket –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è
  - –ü–æ–∫–∞–∑—ã–≤–∞–µ–º fallback: "‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ä–≤–µ—Ä–æ–º, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ"
- **–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é**: "–î–∞–Ω–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã. –í–∞—à–∏ –ø–ª–∞—Ç–µ–∂–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –ø–æ–∑–∂–µ."
- **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: Supabase SLA 99.9%, —Ä–µ–¥–∫–∞—è —Å–∏—Ç—É–∞—Ü–∏—è

---

## UI/UX –î–∏–∑–∞–π–Ω

### –û—Å–Ω–æ–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

**–≠–∫—Ä–∞–Ω 1: –í–∫–ª–∞–¥–∫–∞ "–ö–ª—É–±" (–¥–æ –æ–ø–ª–∞—Ç—ã)**
- –ó–∞–≥–æ–ª–æ–≤–æ–∫ "–ó–∞–∫—Ä—ã—Ç—ã–π –∫–ª—É–±"
- –û–ø–∏—Å–∞–Ω–∏–µ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ (–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –≤—Å—Ç—Ä–µ—á–∏, Zoom)
- –¶–µ–Ω–∞: "2990 ‚ÇΩ/–º–µ—Å—è—Ü"
- –ö–Ω–æ–ø–∫–∞ "–ö—É–ø–∏—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç" (gradient beige ‚Üí amber)

**–≠–∫—Ä–∞–Ω 2: –í–∫–ª–∞–¥–∫–∞ "–ö–ª—É–±" (–ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã)**
- –°—Ç–∞—Ç—É—Å: "‚úÖ –ê–±–æ–Ω–µ–º–µ–Ω—Ç –∞–∫—Ç–∏–≤–µ–Ω"
- Zoom —Å—Å—ã–ª–∫–∞ (–∫–ª–∏–∫–∞–±–µ–ª—å–Ω–∞—è, –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ)
- –î–∞—Ç–∞ —Å–ª–µ–¥—É—é—â–µ–π –≤—Å—Ç—Ä–µ—á–∏
- –ö–Ω–æ–ø–∫–∞ "–û—Ç–º–µ–Ω–∏—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç" (destructive color)

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç 1: Success Popup**
- –ò–∫–æ–Ω–∫–∞: ‚úÖ (–∑–µ–ª—ë–Ω–∞—è –≥–∞–ª–æ—á–∫–∞)
- –ó–∞–≥–æ–ª–æ–≤–æ–∫: "–ì–æ—Ç–æ–≤–æ"
- –°–æ–æ–±—â–µ–Ω–∏–µ: "‚úÖ –ê–±–æ–Ω–µ–º–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ –∫—É–ø–ª–µ–Ω!"
- –ö–Ω–æ–ø–∫–∞ "–û–ö" (–∑–∞–∫—Ä—ã–≤–∞–µ—Ç popup)
- Haptic feedback: `notificationOccurred('success')`

### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

- **–ö–ª–∏–∫ –Ω–∞ "–ö—É–ø–∏—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç"**:
  - Haptic: `selectionChanged()`
  - –°–æ–∑–¥–∞—ë—Ç—Å—è –ø–ª–∞—Ç—ë–∂ ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –º–æ–¥–∞–ª–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

- **Realtime —Å–æ–±—ã—Ç–∏–µ –ø–æ–ª—É—á–µ–Ω–æ**:
  - Haptic: `notificationOccurred('success')`
  - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è success popup
  - UI –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è (Zoom —Å—Å—ã–ª–∫–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è)

- **–ö–ª–∏–∫ –Ω–∞ Zoom —Å—Å—ã–ª–∫—É**:
  - –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ (Telegram.WebApp.openLink)
  - Haptic: `impactOccurred('light')`

- **–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö**:
  - Haptic: `notificationOccurred('error')`
  - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è error message

---

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –í–Ω–µ—à–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

- **Supabase**:
  - PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (—Ç–∞–±–ª–∏—Ü–∞ `club_payments`)
  - Realtime WebSocket API (–ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è)
  - REST API (—á—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ)
  - Supabase JS SDK v2 (CDN: `https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2`)

- **Make.com**:
  - –ú–∞—Ä—à—Ä—É—Ç: YooKassa webhook ‚Üí Supabase Insert
  - –ú–æ–¥—É–ª—å: "Supabase ‚Üí Insert a record"
  - Credentials: `service_role` –∫–ª—é—á (—Å–µ–∫—Ä–µ—Ç–Ω—ã–π!)

- **YooKassa**:
  - Webhook –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç–µ (`payment.succeeded`)
  - –ù–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

### –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–§–∞–π–ª—ã**:
- `config.js` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã `SUPABASE_URL`, `SUPABASE_ANON_KEY`
- `app.js` ‚Äî –∑–∞–º–µ–Ω–∏—Ç—å `loadClubData()` –Ω–∞ Supabase –∫–ª–∏–µ–Ω—Ç + Realtime –ø–æ–¥–ø–∏—Å–∫—É
- `index.html` ‚Äî –ø–æ–¥–∫–ª—é—á–∏—Ç—å Supabase SDK (CDN)
- `club.json` ‚Äî —É–¥–∞–ª–∏—Ç—å –∏–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**:
- `showSuccessPopup()` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ Realtime —Å–æ–±—ã—Ç–∏—è
- `renderClubView()` ‚Äî –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ Supabase
- `tg.HapticFeedback` ‚Äî –¥–ª—è —Ç–∞–∫—Ç–∏–ª—å–Ω–æ–≥–æ –æ—Ç–∫–ª–∏–∫–∞

**–£–¥–∞–ª—è–µ–º—ã–π –∫–æ–¥**:
- `loadClubData()` ‚Äî –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ Supabase –∑–∞–ø—Ä–æ—Å
- `startClubPaymentPolling()` ‚Äî –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω (Realtime)
- `startBackgroundPolling()` ‚Äî –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω (Realtime)
- `CacheManager` –¥–ª—è `club_data` ‚Äî Supabase –Ω–µ –∫–µ—à–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

---

## –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

### –ö–∞–∫ –∏–∑–º–µ—Ä–∏–º —É—Å–ø–µ—Ö —Ñ–∏—á–∏?

**–ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏**:

1. **–í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: –æ—Ç webhook YooKassa –¥–æ popup –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
   - **–¶–µ–ª—å**: < 1 —Å–µ–∫—É–Ω–¥–∞ (99 –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å)
   - **–ò–∑–º–µ—Ä–µ–Ω–∏–µ**: timestamp –≤ `payment_data.created_at` vs timestamp –ø–æ–ª—É—á–µ–Ω–∏—è Realtime event

2. **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å Realtime**:
   - **–¶–µ–ª—å**: 99% —Å–æ–±—ã—Ç–∏–π –¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ WebSocket
   - **–ò–∑–º–µ—Ä–µ–Ω–∏–µ**: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–æ–ª-–≤–∞ –ø–ª–∞—Ç–µ–∂–µ–π –≤ Supabase vs –∫–æ–ª-–≤–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö Realtime events
   - **Fallback**: REST –∑–∞–ø—Ä–æ—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã–µ 1%

3. **–†–∞–∑–º–µ—Ä –±–∞–Ω–¥–ª–∞**:
   - **–î–æ**: app.js + polling –∫–æ–¥ ‚âà 120KB
   - **–ü–æ—Å–ª–µ**: app.js + Supabase SDK ‚âà 150KB (–ø—Ä–∏–µ–º–ª–µ–º–æ)
   - **–¶–µ–ª—å**: < 200KB gzipped

4. **–£–º–µ–Ω—å—à–µ–Ω–∏–µ polling –∑–∞–ø—Ä–æ—Å–æ–≤**:
   - **–î–æ**: 50 –∑–∞–ø—Ä–æ—Å–æ–≤ √ó –∫–∞–∂–¥—ã–π –ø–ª–∞—Ç—ë–∂ = 50 √ó N –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–µ—Å—è—Ü
   - **–ü–æ—Å–ª–µ**: 0 polling –∑–∞–ø—Ä–æ—Å–æ–≤ (—Ç–æ–ª—å–∫–æ Realtime + 1 REST –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ)
   - **–¶–µ–ª—å**: 98% —Å–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤

**–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏**:

1. **UX —É–ª—É—á—à–µ–Ω–∏–µ**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ ‚Üí –º–µ–Ω—å—à–µ —Å–æ–º–Ω–µ–Ω–∏–π "–ø—Ä–æ—à–ª–∞ –ª–∏ –æ–ø–ª–∞—Ç–∞?"
2. **–¢–µ—Ö–¥–æ–ª–≥**: —É–±–∏—Ä–∞–µ–º —Å–ª–æ–∂–Ω—ã–π polling –∫–æ–¥ ‚Üí –ø—Ä–æ—â–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å
3. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ —Ç–∞–±–ª–∏—Ü—ã (–≤—Å—Ç—Ä–µ—á–∏, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∑–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö

### 1. Row Level Security (RLS) ‚Äî –û—Å–Ω–æ–≤–∞ –∑–∞—â–∏—Ç—ã

**–ö–æ–Ω—Ü–µ–ø—Ü–∏—è**: Supabase RLS ‚Äî —ç—Ç–æ PostgreSQL —Ñ–∏—á–∞, –∫–æ—Ç–æ—Ä–∞—è —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —Å—Ç—Ä–æ–∫–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –î–∞–∂–µ –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ –ø–æ–ª—É—á–∏—Ç –¥–æ—Å—Ç—É–ø –∫ `anon` –∫–ª—é—á—É, –æ–Ω–∏ –Ω–µ —Å–º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å/–ø–∏—Å–∞—Ç—å —á—É–∂–∏–µ –¥–∞–Ω–Ω—ã–µ.

**SQL –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è `club_payments`**:

```sql
-- –í–∫–ª—é—á–∞–µ–º RLS (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
ALTER TABLE club_payments ENABLE ROW LEVEL SECURITY;

-- –ü–æ–ª–∏—Ç–∏–∫–∞ 1: –ü—É–±–ª–∏—á–Ω–æ–µ —á—Ç–µ–Ω–∏–µ –í–°–ï–• succeeded –ø–ª–∞—Ç–µ–∂–µ–π (–¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞)
CREATE POLICY "Allow public read succeeded payments"
ON club_payments
FOR SELECT
USING (status = 'succeeded');

-- –ü–æ–ª–∏—Ç–∏–∫–∞ 2: –ó–∞–ø—Ä–µ—Ç–∏—Ç—å INSERT –¥–ª—è anon –∫–ª—é—á–∞ (—Ç–æ–ª—å–∫–æ service_role)
CREATE POLICY "Deny public insert"
ON club_payments
FOR INSERT
WITH CHECK (false);

-- –ü–æ–ª–∏—Ç–∏–∫–∞ 3: –ó–∞–ø—Ä–µ—Ç–∏—Ç—å UPDATE –¥–ª—è anon –∫–ª—é—á–∞
CREATE POLICY "Deny public update"
ON club_payments
FOR UPDATE
USING (false);

-- –ü–æ–ª–∏—Ç–∏–∫–∞ 4: –ó–∞–ø—Ä–µ—Ç–∏—Ç—å DELETE –¥–ª—è anon –∫–ª—é—á–∞
CREATE POLICY "Deny public delete"
ON club_payments
FOR DELETE
USING (false);
```

**–í–∞–∂–Ω–æ**:
- ‚ùå –ù–ï —Ñ–∏–ª—å—Ç—Ä—É–µ–º –ø–æ `telegram_user_id` –≤ RLS (–∏–Ω–∞—á–µ Realtime –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—é –¥–µ–ª–∞–µ–º –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ: `?telegram_user_id=eq.{userId}`
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ `succeeded` –ø–ª–∞—Ç–µ–∂–∏ (pending/canceled —Å–∫—Ä—ã—Ç—ã)

---

### 2. API –ö–ª—é—á–∏ ‚Äî –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞

**–î–≤–∞ —É—Ä–æ–≤–Ω—è –¥–æ—Å—Ç—É–ø–∞**:

| –ö–ª—é—á | –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è | –ü—Ä–∞–≤–∞ | –ü—É–±–ª–∏—á–Ω—ã–π? | –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å |
|------|------------------|-------|------------|-------------|
| `anon` | –§—Ä–æ–Ω—Ç–µ–Ω–¥ (app.js) | SELECT succeeded –ø–ª–∞—Ç–µ–∂–µ–π | ‚úÖ –î–ê | `config.js` (–æ—Ç–∫—Ä—ã—Ç–æ) |
| `service_role` | Make.com | –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø (INSERT/UPDATE/DELETE) | ‚ùå –ù–ï–¢ | Make.com environment (—Å–µ–∫—Ä–µ—Ç–Ω–æ!) |

**–ó–∞—â–∏—Ç–∞ `service_role` –∫–ª—é—á–∞**:

```javascript
// ‚ùå –ù–ò–ö–û–ì–î–ê –ù–ï –î–ï–õ–ê–ô –¢–ê–ö:
const SUPABASE_SERVICE_KEY = 'eyJhbGc...'; // –í –∫–æ–¥–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞!!!

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
// config.js ‚Äî –¢–û–õ–¨–ö–û anon –∫–ª—é—á
SUPABASE_ANON_KEY: 'eyJhbGc...anon...',

// Make.com ‚Äî service_role –≤ —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
// –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí Environment Variables ‚Üí SUPABASE_SERVICE_KEY
```

**–†–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π** (–ø—Ä–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏):
1. –ó–∞–π—Ç–∏ –≤ Supabase Dashboard ‚Üí Settings ‚Üí API
2. –ù–∞–∂–∞—Ç—å "Generate new anon key" –∏–ª–∏ "Regenerate service_role"
3. –û–±–Ω–æ–≤–∏—Ç—å –≤ `config.js` (anon) –∏ Make.com (service_role)
4. –°—Ç–∞—Ä—ã–µ –∫–ª—é—á–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è

---

### 3. SQL Injection ‚Äî –ó–∞—â–∏—Ç–∞

**Supabase –∑–∞—â–∏—â–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**: –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ REST API –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω—ã.

```javascript
// ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û (–ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å)
const { data } = await supabase
  .from('club_payments')
  .select('*')
  .eq('telegram_user_id', userId); // userId –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä

// ‚ùå –û–ü–ê–°–ù–û (–µ—Å–ª–∏ –±—ã –º—ã –¥–µ–ª–∞–ª–∏ raw SQL –≤ –∫–æ–¥–µ)
const query = `SELECT * FROM club_payments WHERE telegram_user_id = ${userId}`;
// –ù–ï –î–ï–õ–ê–ô –¢–ê–ö! (–Ω–æ Supabase SDK –Ω–µ –ø–æ–∑–≤–æ–ª–∏—Ç)
```

**Make.com**: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–¥—É–ª—å "Supabase ‚Üí Insert record", –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ.

---

### 4. HTTPS / TLS ‚Äî –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞

**–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –¢–û–õ–¨–ö–û —á–µ—Ä–µ–∑ HTTPS**:

```javascript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
SUPABASE_URL: 'https://your-project.supabase.co' // HTTPS!

// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
SUPABASE_URL: 'http://your-project.supabase.co' // HTTP ‚Äî –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ!
```

**–ß—Ç–æ –∑–∞—â–∏—â–µ–Ω–æ**:
- REST API –∑–∞–ø—Ä–æ—Å—ã (GET /club_payments) ‚Üí TLS 1.3
- Realtime WebSocket ‚Üí WSS (WebSocket Secure)
- Supabase Dashboard ‚Üí HTTPS

**–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã**: Supabase –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Let's Encrypt (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ).

---

### 5. Rate Limiting ‚Äî –ó–∞—â–∏—Ç–∞ –æ—Ç DDoS

**Supabase –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π Rate Limiting**:

| –î–µ–π—Å—Ç–≤–∏–µ | –õ–∏–º–∏—Ç (Free Tier) | –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ |
|----------|-------------------|-------------------------------|
| REST API –∑–∞–ø—Ä–æ—Å—ã | 500 req/sec | HTTP 429 (Too Many Requests) |
| Realtime –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è | 200 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö | –ù–æ–≤—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –æ—Ç–∫–ª–æ–Ω—è—é—Ç—Å—è |
| Auth –æ–ø–µ—Ä–∞—Ü–∏–∏ | 30 req/hour –Ω–∞ IP | HTTP 429 |

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ**:

```javascript
// Debounce –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Å–ø–∞–º–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
let lastFetchTime = 0;
const FETCH_COOLDOWN = 1000; // 1 —Å–µ–∫—É–Ω–¥–∞

async function loadPayments() {
  const now = Date.now();
  if (now - lastFetchTime < FETCH_COOLDOWN) {
    console.warn('‚è±Ô∏è –°–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º');
    return;
  }

  lastFetchTime = now;
  // ... –¥–µ–ª–∞–µ–º –∑–∞–ø—Ä–æ—Å
}
```

---

### 6. –ê—É–¥–∏—Ç –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ–º**:

1. **Make.com**:
   - –í—Å–µ webhook –∑–∞–ø—Ä–æ—Å—ã –æ—Ç YooKassa (timestamp, payment_id, amount)
   - –£—Å–ø–µ—à–Ω—ã–µ/–Ω–µ—É–¥–∞—á–Ω—ã–µ INSERT –≤ Supabase
   - –û—à–∏–±–∫–∏ (–Ω–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á, constraint violations)

2. **Supabase**:
   - –í–∫–ª—é—á–∏—Ç—å "Database Webhooks" –¥–ª—è –∞—É–¥–∏—Ç–∞ INSERT/UPDATE/DELETE
   - –õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ Dashboard ‚Üí Database ‚Üí Logs
   - SQL –∑–∞–ø—Ä–æ—Å—ã —Å –º–µ–¥–ª–µ–Ω–Ω—ã–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º (> 1 sec)

3. **–§—Ä–æ–Ω—Ç–µ–Ω–¥** (app.js):
   ```javascript
   // –õ–æ–≥–∏—Ä—É–µ–º –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
   console.log('üîí [Security] Supabase connected', {
     url: CONFIG.SUPABASE_URL,
     keyType: 'anon' // –ù–ï –ª–æ–≥–∏—Ä—É–µ–º —Å–∞–º –∫–ª—é—á!
   });

   // –õ–æ–≥–∏—Ä—É–µ–º Realtime —Å–æ–±—ã—Ç–∏—è
   supabase.channel('audit').on('postgres_changes',
     { event: 'INSERT', schema: 'public', table: 'club_payments' },
     (payload) => {
       console.log('üîí [Audit] New payment received', {
         payment_id: payload.new.payment_id,
         user_id: payload.new.telegram_user_id,
         timestamp: new Date().toISOString()
       });
     }
   );
   ```

**Retention (—Å–∫–æ–ª—å–∫–æ —Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–≥–∏)**:
- Supabase Free Tier: 7 –¥–Ω–µ–π
- Production (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è): 30+ –¥–Ω–µ–π (—ç–∫—Å–ø–æ—Ä—Ç –≤ S3 –∏–ª–∏ CloudWatch)

---

### 7. –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ù–∞ —Å—Ç–æ—Ä–æ–Ω–µ Make.com** (–ø–µ—Ä–µ–¥ INSERT):

```javascript
// –ü—Å–µ–≤–¥–æ–∫–æ–¥ –¥–ª—è Make.com –º–æ–¥—É–ª—è "Filter"
if (!payment.id || payment.id.length < 10) {
  throw new Error('Invalid payment_id');
}

if (!payment.telegram_user_id || payment.telegram_user_id < 1) {
  throw new Error('Invalid telegram_user_id');
}

if (payment.amount !== 299000) { // 2990‚ÇΩ –≤ –∫–æ–ø–µ–π–∫–∞—Ö
  throw new Error('Invalid amount (must be 299000)');
}

if (!['pending', 'succeeded', 'canceled'].includes(payment.status)) {
  throw new Error('Invalid status');
}
```

**–ù–∞ —Å—Ç–æ—Ä–æ–Ω–µ PostgreSQL** (constraints):

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ payment_id (–∑–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–µ–π)
ALTER TABLE club_payments
ADD CONSTRAINT unique_payment_id UNIQUE (payment_id);

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ amount –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π
ALTER TABLE club_payments
ADD CONSTRAINT positive_amount CHECK (amount > 0);

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤
ALTER TABLE club_payments
ADD CONSTRAINT valid_status CHECK (status IN ('pending', 'succeeded', 'canceled'));
```

---

### 8. –ó–∞—â–∏—Ç–∞ –æ—Ç —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö

**–ß—Ç–æ —Å–∫—Ä—ã–≤–∞–µ–º**:

1. **–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**:
   - RLS –ø–æ–ª–∏—Ç–∏–∫–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∏–¥–µ—Ç—å –í–°–ï succeeded –ø–ª–∞—Ç–µ–∂–∏, –ù–û
   - –ù–∞ –∫–ª–∏–µ–Ω—Ç–µ —Ñ–∏–ª—å—Ç—Ä—É–µ–º: `.eq('telegram_user_id', userId)`
   - –î—Ä—É–≥–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –º–æ–≥—É—Ç —É–≤–∏–¥–µ—Ç—å —á—É–∂–∏–µ –ø–ª–∞—Ç–µ–∂–∏ —á–µ—Ä–µ–∑ DevTools

   **–†–µ—à–µ–Ω–∏–µ** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏):
   ```sql
   -- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è RLS: –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –ø–ª–∞—Ç–µ–∂–∏
   -- –ù–û: Realtime –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å (–Ω—É–∂–µ–Ω auth.uid())
   CREATE POLICY "Users see only own payments"
   ON club_payments
   FOR SELECT
   USING (telegram_user_id = current_setting('app.telegram_user_id')::bigint);
   ```

2. **–°–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏**:
   - ‚ùå –ù–ï –ª–æ–≥–∏—Ä—É–µ–º API –∫–ª—é—á–∏ –≤ –∫–æ–Ω—Å–æ–ª—å
   - ‚ùå –ù–ï –∫–æ–º–º–∏—Ç–∏–º `.env` —Ñ–∞–π–ª—ã —Å –∫–ª—é—á–∞–º–∏
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Make.com

3. **Payment metadata**:
   - –ü–æ–ª–µ `payment_data` (JSONB) –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å email, –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç YooKassa
   - **–ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º** –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤ Supabase Dashboard)

---

### 9. CORS –∏ Origin Validation

**Supabase –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω**:
- CORS —Ä–∞–∑—Ä–µ—à—ë–Ω –¥–ª—è –≤—Å–µ—Ö –¥–æ–º–µ–Ω–æ–≤ (–ø—É–±–ª–∏—á–Ω—ã–π API —Å anon –∫–ª—é—á–æ–º)
- –ó–∞—â–∏—Ç–∞ —á–µ—Ä–µ–∑ RLS, –∞ –Ω–µ —á–µ—Ä–µ–∑ CORS

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
- –í Supabase Dashboard ‚Üí Authentication ‚Üí URL Configuration
- –î–æ–±–∞–≤–∏—Ç—å "Site URL": `https://andseleznev-lab.github.io/-TGBOT`
- –î–æ–±–∞–≤–∏—Ç—å "Redirect URLs": —Ç–æ–ª—å–∫–æ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã

---

### 10. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–†–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏** (–∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é):

1. **Supabase Dashboard ‚Üí Database ‚Üí Logs**:
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–µ–æ–±—ã—á–Ω—ã–µ INSERT/UPDATE/DELETE (–Ω–µ –æ—Ç Make.com)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å failed auth attempts

2. **Make.com ‚Üí Scenario History**:
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—à–∏–±–∫–∏ webhook (–≤–æ–∑–º–æ–∂–Ω—ã–µ –∞—Ç–∞–∫–∏)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ (DDoS?)

3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ RLS**:
   ```javascript
   // –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø–∏—Å–∏ —Å anon –∫–ª—é—á–æ–º (–¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–≤–∞–ª–∏—Ç—å—Å—è)
   const { error } = await supabase
     .from('club_payments')
     .insert({ telegram_user_id: 123, amount: 1 });

   console.assert(error, 'RLS –¥–æ–ª–∂–µ–Ω –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å INSERT!');
   ```

**–ê–ª–µ—Ä—Ç—ã** (–Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ Supabase):
- Email –ø—Ä–∏ 10+ failed queries –∑–∞ –º–∏–Ω—É—Ç—É
- Email –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ 80% storage quota
- Email –ø—Ä–∏ downtime > 5 –º–∏–Ω—É—Ç

---

### 11. Compliance –∏ Privacy

**GDPR / –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**:
- `telegram_user_id` ‚Äî –ø—Å–µ–≤–¥–æ–Ω–∏–º (–Ω–µ –§–ò–û), –Ω–æ –≤—Å—ë —Ä–∞–≤–Ω–æ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ü—Ä–∞–≤–æ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ —Å–≤–æ–∏—Ö –ø–ª–∞—Ç–µ–∂–µ–π
- –°—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è: 3 –≥–æ–¥–∞ (–¥–ª—è –Ω–∞–ª–æ–≥–æ–≤–æ–π –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏ –†–§)

**SQL –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**:
```sql
-- Soft delete (–ø–æ–º–µ—á–∞–µ–º –∫–∞–∫ deleted, –Ω–æ –Ω–µ —É–¥–∞–ª—è–µ–º —Ñ–∏–∑–∏—á–µ—Å–∫–∏)
UPDATE club_payments
SET status = 'deleted',
    payment_data = NULL -- –æ—á–∏—â–∞–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
WHERE telegram_user_id = 156702946;

-- Hard delete (–ø–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ, —Ç–æ–ª—å–∫–æ –ø–æ –∑–∞–ø—Ä–æ—Å—É)
DELETE FROM club_payments
WHERE telegram_user_id = 156702946;
```

---

### 12. –ß–µ–∫-–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- [ ] RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –≤–∫–ª—é—á–µ–Ω—ã (`ENABLE ROW LEVEL SECURITY`)
- [ ] `anon` –∫–ª—é—á –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¢–û–õ–¨–ö–û –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
- [ ] `service_role` –∫–ª—é—á –ù–ï –∑–∞–∫–æ–º–º–∏—á–µ–Ω –≤ Git
- [ ] HTTPS –¥–ª—è –≤—Å–µ—Ö endpoints (–Ω–µ HTTP)
- [ ] SQL constraints –¥–æ–±–∞–≤–ª–µ–Ω—ã (unique, check)
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ Make.com –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ (Make.com + Supabase)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã RLS –ø–æ–ª–∏—Ç–∏–∫–∏ (–ø–æ–ø—ã—Ç–∫–∞ INSERT —Å anon –∫–ª—é—á–æ–º)
- [ ] Rate limiting –ø—Ä–æ–≤–µ—Ä–µ–Ω (—Å–ø–∞–º –∑–∞–ø—Ä–æ—Å–æ–≤)
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (email alerts)
- [ ] CORS/Origin –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- [ ] GDPR compliance: –ø—Ä–æ—Ü–µ—Å—Å —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ–ø–∏—Å–∞–Ω

---

## –†–∏—Å–∫–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏

**–†–∏—Å–∫ 1**: Supabase Free Tier –ª–∏–º–∏—Ç—ã (500MB DB, 2GB egress/–º–µ—Å—è—Ü)
- **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å**: –ù–∏–∑–∫–∞—è (–Ω–∞ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–æ–µ–∫—Ç–∞)
- **–í–ª–∏—è–Ω–∏–µ**: –°—Ä–µ–¥–Ω–µ–µ (–Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ –ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω)
- **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
  - –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ Supabase Dashboard
  - –¢–∞–±–ª–∏—Ü–∞ `club_payments` –æ—á–µ–Ω—å –ª–µ–≥–∫–æ–≤–µ—Å–Ω–∞—è (< 1KB –Ω–∞ –ø–ª–∞—Ç—ë–∂)
  - –ü—Ä–∏ 1000 –ø–ª–∞—Ç–µ–∂–µ–π –≤ –º–µ—Å—è—Ü = 1MB (–¥–∞–ª–µ–∫–æ –æ—Ç –ª–∏–º–∏—Ç–∞)

**–†–∏—Å–∫ 2**: Realtime WebSocket –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö/—Å–µ—Ç—è—Ö
- **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å**: –ù–∏–∑–∫–∞—è (WebSocket –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤–µ–∑–¥–µ —Å 2012 –≥–æ–¥–∞)
- **–í–ª–∏—è–Ω–∏–µ**: –°—Ä–µ–¥–Ω–µ–µ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –ø–æ–ª—É—á–∞—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
- **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
  - Graceful fallback: REST –∑–∞–ø—Ä–æ—Å –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫ (–µ—Å–ª–∏ –æ–∂–∏–¥–∞–µ—Ç—Å—è –ø–ª–∞—Ç—ë–∂)
  - –ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–ö–ª—É–±" –≤—Å–µ–≥–¥–∞ –¥–µ–ª–∞–µ–º REST –∑–∞–ø—Ä–æ—Å

**–†–∏—Å–∫ 3**: Make.com –Ω–µ –º–æ–∂–µ—Ç –∑–∞–ø–∏—Å–∞—Ç—å –≤ Supabase (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ credentials)
- **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å**: –°—Ä–µ–¥–Ω—è—è (–æ—à–∏–±–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
- **–í–ª–∏—è–Ω–∏–µ**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ (–ø–ª–∞—Ç–µ–∂–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è!)
- **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
  - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å Make.com —Å—Ü–µ–Ω–∞—Ä–∏–π –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º (—Ç–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç—ë–∂)
  - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –≤ Make.com
  - –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è: club.json (–≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ fallback)

**–†–∏—Å–∫ 4**: Row Level Security (RLS) –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ ‚Üí —É—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å**: –ù–∏–∑–∫–∞—è (—Ç–µ—Å—Ç–∏—Ä—É–µ–º –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º)
- **–í–ª–∏—è–Ω–∏–µ**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ (–¥—Ä—É–≥–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å —á—É–∂–∏–µ –ø–ª–∞—Ç–µ–∂–∏)
- **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
  - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å RLS –ø–æ–ª–∏—Ç–∏–∫–∏ (–ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç—å —á—É–∂–∏–µ –¥–∞–Ω–Ω—ã–µ —Å `anon` –∫–ª—é—á–æ–º)
  - Code review SQL –º–∏–≥—Ä–∞—Ü–∏–π

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- **Supabase Free Tier**: 500MB –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, 2GB egress –≤ –º–µ—Å—è—Ü
  - –ü—Ä–∏ —Ä–æ—Å—Ç–µ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ Pro ($25/–º–µ—Å—è—Ü)

- **Make.com –ª–∏–º–∏—Ç**: 1000 –æ–ø–µ—Ä–∞—Ü–∏–π –≤ –º–µ—Å—è—Ü (Free tier)
  - –ü—Ä–∏ 1000+ –ø–ª–∞—Ç–µ–∂–µ–π –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ –ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω

- **Telegram Mini Apps**: –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç Service Workers (–Ω–µ–ª—å–∑—è –ø–æ–ª—É—á–∞—Ç—å push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Ñ–æ–Ω–µ)
  - Realtime —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–æ

- **–ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π**: Supabase Realtime –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ—à–ª—ã–µ —Å–æ–±—ã—Ç–∏—è (—Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ INSERT)
  - –ü–æ—ç—Ç–æ–º—É –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–µ–ª–∞–µ–º REST –∑–∞–ø—Ä–æ—Å

---

## –û—Ç–∫—Ä—ã—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

- [x] **–í–æ–ø—Ä–æ—Å 1**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å REST API –∏–ª–∏ Supabase SDK?
  - **–†–µ—à–µ–Ω–æ**: Supabase SDK (–ø—Ä–æ—â–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Realtime, –º–µ–Ω—å—à–µ –∫–æ–¥–∞)

- [x] **–í–æ–ø—Ä–æ—Å 2**: –£–¥–∞–ª—è—Ç—å –ª–∏ club.json –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è?
  - **–†–µ—à–µ–Ω–æ**: –û—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é (–ø—É—Å—Ç–æ–π —Ñ–∞–π–ª), –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–æ–¥–µ

- [x] **–í–æ–ø—Ä–æ—Å 3**: –ù—É–∂–Ω–∞ –ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö?
  - **–†–µ—à–µ–Ω–æ**: –î–∞, –µ—Å–ª–∏ –≤ club.json –µ—Å—Ç—å –ø–ª–∞—Ç–µ–∂–∏ ‚Üí —Ä–∞–∑–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏

- [ ] **–í–æ–ø—Ä–æ—Å 4**: –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–∏ –∏—Å—Ç–æ—Ä–∏—é –≤—Å–µ—Ö –ø–ª–∞—Ç–µ–∂–µ–π –∏–ª–∏ —Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â–∏–π –∞–±–æ–Ω–µ–º–µ–Ω—Ç?
  - **TODO**: –£—Ç–æ—á–Ω–∏—Ç—å —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## –†–µ—à–µ–Ω–∏—è –∏ —É—Ç–æ—á–Ω–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ –ø–æ –≤–æ–ø—Ä–æ—Å—É 1 (SDK vs REST)
**2026-02-14**: –ò—Å–ø–æ–ª—å–∑—É–µ–º Supabase JS SDK v2
- –ü–ª—é—Å—ã: Realtime –∏–∑ –∫–æ—Ä–æ–±–∫–∏, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π reconnect, –º–µ–Ω—å—à–µ –∫–æ–¥–∞
- –ú–∏–Ω—É—Å—ã: +50KB –∫ –±–∞–Ω–¥–ª—É (–ø—Ä–∏–µ–º–ª–µ–º–æ)

### –†–µ—à–µ–Ω–∏–µ –ø–æ –≤–æ–ø—Ä–æ—Å—É 2 (club.json)
**2026-02-14**: –û—Å—Ç–∞–≤–ª—è–µ–º club.json –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é (–ø—É—Å—Ç–æ–π)
- –ù–µ —É–¥–∞–ª—è–µ–º —Ñ–∞–π–ª (–º–æ–∂–µ—Ç –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è –¥–ª—è –∞–≤–∞—Ä–∏–π–Ω–æ–≥–æ –æ—Ç–∫–∞—Ç–∞)
- –ù–æ –∫–æ–¥ –±–æ–ª—å—à–µ –Ω–µ —á–∏—Ç–∞–µ—Ç –∏–∑ –Ω–µ–≥–æ

### –†–µ—à–µ–Ω–∏–µ –ø–æ –≤–æ–ø—Ä–æ—Å—É 3 (–º–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö)
**2026-02-14**: –°–æ–∑–¥–∞—ë–º —Ä–∞–∑–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
- –ß–∏—Ç–∞–µ–º club.json
- –í—Å—Ç–∞–≤–ª—è–µ–º –≤—Å–µ –ø–ª–∞—Ç–µ–∂–∏ –≤ Supabase —á–µ—Ä–µ–∑ REST API
- –ó–∞–ø—É—Å–∫–∞–µ–º –æ–¥–∏–Ω —Ä–∞–∑ –≤—Ä—É—á–Ω—É—é

---

## –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

**2026-02-14 v1.0**:
- –ü–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è PRD
- –í—ã–±—Ä–∞–Ω –ø–æ–¥—Ö–æ–¥: Supabase SDK + Realtime
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã Must Have —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –û–ø–∏—Å–∞–Ω—ã —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ —Ä–∏—Å–∫–∏

---

## –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ PRD

–ü–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ —ç—Ç–∞–ø—É –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —É–±–µ–¥–∏—Å—å:

- [x] –ü–æ–Ω—è—Ç–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –∏ —Ü–µ–ª—å —Ñ–∏—á–∏
- [x] –û–ø–∏—Å–∞–Ω—ã –≤—Å–µ must-have —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- [x] –†–∞—Å–ø–∏—Å–∞–Ω happy path –∏ –æ—Å–Ω–æ–≤–Ω—ã–µ edge cases
- [x] –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –º–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞
- [x] –í—ã—è–≤–ª–µ–Ω—ã —Ä–∏—Å–∫–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- [x] –í—Å–µ –±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –∑–∞–∫—Ä—ã—Ç—ã
- [x] –°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω—ë–Ω –Ω–∞ `PRD_READY`

**‚úÖ PRD –≥–æ—Ç–æ–≤ –∫ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é!**
